"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}();!function(e){!function(e){var n={attach:function(e,n){return this.hasOwnProperty(e)?!1:(this[e]=null,"undefined"!=typeof n&&(this[e]=n),!0)},detach:function(e){var n=void 0;return this.hasOwnProperty(e)&&(n=this[e],delete this[e]),n}};e.id=n}(e),function(e){var n=new(e.AudioContext||e.webkitAudioContext),t=void 0,a=void 0,r=void 0,o=void 0,i=function(e,n,t){if(e.length>=n)return String(e);for("undefined"==typeof t&&(t=" "),e=String(e);e.length<n;)e=t+e;return e},u=function(e){return i(Math.round(e/60),2,"0")+":"+i(Math.round(e%60),2,"0")};e.onEnded=function(){};var l=function(){function o(i){var u=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];_classCallCheck(this,o),t=new Audio,null!==i&&(t.src=i);var l=n.createMediaElementSource(t);a=n.createGain(),r=n.createAnalyser(),l.connect(a),l.connect(r),a.connect(n.destination),null!==i&&t.addEventListener("loadeddata",function(){u&&t.play()}),t.onended=function(){e.hasOwnProperty("audioEnded")&&e.audioEnded.call(e)},t.onprogress=function(){if(e.hasOwnProperty("audioProgress")){var n=t.buffered,a=t.currentTime,r=t.duration;n&&a&&r&&e.audioProgress.call(e,n,a,r)}},t.oncanplay=function(){e.hasOwnProperty("audioCanPlay")&&e.audioCanPlay.call(e)},t.oncanplaythrough=function(){e.hasOwnProperty("audioCanPlayThrough")&&e.audioCanPlayThrough.call(e)}}return _createClass(o,[{key:"change",value:function(){return t.paused?(t.play(),!0):(t.pause(),!1)}},{key:"paused",value:function(){return t.pause}},{key:"seek",value:function(e){console.log("seek",e),e>=0&&1>=e?t.currentTime=Math.round(e*t.duration):e>=0&&e<=t.duration&&(t.currentTime=e)}},{key:"setVol",value:function(e){e>=0&&1>=e&&(a.gain.value=e)}},{key:"vollume",value:function(e){a.gain.value+e>=0&&a.gain.value+e<=1&&(a.gain.value+=e)}},{key:"getAnalyzer",value:function(){return r}},{key:"timeline",value:function(){return t.currentTime/t.duration}},{key:"loop",value:function(e){t.loop=e}},{key:"close",value:function(){t.removeAttribute("src"),t.load()}},{key:"muteChange",value:function(){return t.muted=!t.muted,t.muted}},{key:"muted",value:function(){return t.muted}},{key:"calcTime",value:function(e){var n=e*t.duration;return u(n)+"/"+u(t.duration)}}]),o}();e.createAudioApplication=function(e){return"undefined"!=typeof o&&o.close(),o=new l(e)}}(e);var n=void 0,t=void 0,a=void 0,r=function(e,r,o){function i(){a=requestAnimationFrame(i),o.getByteFrequencyData(c),r.clearRect(0,0,n,t),r.fillStyle=f;for(var e=c.length,u=c[0],l=0;e>l;l++){var d=c[l];r.fillRect(8*l,3*t/4-d,5,d),r.beginPath(),r.moveTo(8*l,3*t/4),r.lineTo(8*l+5,3*t/4),r.strokeStyle="#000",r.lineWidth=1,r.stroke(),u<c[l]&&(u=c[l])}for(var s=8,v=s;u>v;v+=s)r.clearRect(0,3*t/4-v,n,1)}var u=arguments.length<=3||void 0===arguments[3]?.3:arguments[3];o.smoothingTimeConstant=u,o.fftSize=512;var l=o.frequencyBinCount,c=new Uint8Array(l);r.clearRect(0,0,n,t);var f=r.createLinearGradient(0,0,0,480);f.addColorStop(1,"#000000"),f.addColorStop(.75,"#ff0000"),f.addColorStop(.25,"#ffff00"),f.addColorStop(0,"#ffffff"),"undefined"!=typeof a&&cancelAnimationFrame(a),i()},o=function(e,r,o){function i(){a=requestAnimationFrame(i),o.getByteFrequencyData(c),r.clearRect(0,0,n,t);for(var e,u=n/l*1.5,f=0,d=0;l>d;d++){var s=c[d];e=s,r.fillStyle="rgb("+(e+100)+", 50, 50)",r.fillRect(f,t/2-e/2,u,e/2),r.beginPath(),r.moveTo(f,t/2),r.lineTo(f+u,t/2),r.strokeStyle="rgb( 50, 50, 50)",r.lineWidth=1,r.stroke(),r.fillStyle="rgba("+(e+100)+", 50, 50, 0.8)",r.fillRect(f,t/2,u,e/2),f+=u+4}}var u=arguments.length<=3||void 0===arguments[3]?.4:arguments[3];o.smoothingTimeConstant=u,o.fftSize=128;var l=o.frequencyBinCount,c=new Uint8Array(l);r.clearRect(0,0,n,t),"undefined"!=typeof a&&cancelAnimationFrame(a),i()},i=function(e,r,o){function i(){a=requestAnimationFrame(i),o.getByteFrequencyData(c),r.clearRect(0,0,n,t);for(var e,u=n/50,l=0,f=0;50>f;f++)e=c[f],r.beginPath(),r.moveTo(l,t/2+e/4-e/2),r.lineTo(u+l-1,t/2+e/4-e/2),r.strokeStyle="yellow",r.lineWidth=1,r.stroke(),l+=u+4}var u=arguments.length<=3||void 0===arguments[3]?.4:arguments[3];o.smoothingTimeConstant=u,o.fftSize=128;var l=o.frequencyBinCount,c=new Uint8Array(l);r.clearRect(0,0,n,t),"undefined"!=typeof a&&cancelAnimationFrame(a),i()},u=function(e,r,o){function i(){a=requestAnimationFrame(i),o.getByteFrequencyData(d),r.clearRect(0,0,n,t);for(var e=void 0,u=20,f=8,s=f;u>s;s++)e=d[s],r.beginPath(),r.arc(c,l,e,0,2*Math.PI),r.strokeStyle="#3498db",r.lineWidth=2,r.stroke()}var u=arguments.length<=3||void 0===arguments[3]?.2:arguments[3],l=t/2,c=n/2;o.smoothingTimeConstant=u,o.fftSize=128;var f=o.frequencyBinCount,d=new Uint8Array(f);r.clearRect(0,0,n,t),"undefined"!=typeof a&&cancelAnimationFrame(a),i()},l=function(e,r,o){function i(){a=requestAnimationFrame(i),o.getByteTimeDomainData(c),r.clearRect(0,0,n,t),r.lineWidth=2,r.strokeStyle="#f1c40f",r.beginPath();for(var e=1*n/l,u=0,f=0;l>f;f++){var d=c[f]/128,s=d*t/2;0===f?r.moveTo(u,s):r.lineTo(u,s),u+=e}r.lineTo(n,t/2),r.stroke()}var u=arguments.length<=3||void 0===arguments[3]?.8:arguments[3];o.smoothingTimeConstant=u,o.fftSize=2048;var l=o.fftSize,c=new Uint8Array(l);r.clearRect(0,0,n,t),i()},c=function(e){n=e.width,t=e.height},f={init:c,bar:r,bar2:o,line:i,circle:u,sinewave:l};e.audio=f}(window);
